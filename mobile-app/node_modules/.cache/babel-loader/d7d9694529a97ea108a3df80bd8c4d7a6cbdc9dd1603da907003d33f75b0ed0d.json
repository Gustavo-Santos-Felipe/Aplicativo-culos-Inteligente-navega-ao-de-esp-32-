{"ast":null,"code":"import React,{useState,useRef,useEffect,useCallback}from'react';import{GoogleMap,useJsApiLoader,Marker,Autocomplete,DirectionsRenderer}from'@react-google-maps/api';// ##################################################################\n// # COLOQUE SUAS CHAVES E IPs AQUI                                 #\n// ##################################################################\n// 1. CHAVE DA API GOOGLE MAPS PLATFORM\n//    Ative as APIs: \"Maps JavaScript API\", \"Directions API\", \"Places API\"\n//    Instruções: https://developers.google.com/maps/gmp-get-started\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const GOOGLE_MAPS_API_KEY=\"AIzaSyAVEzH5bvFPDpgjQtnA4s2TKfjEW_0OTLY\";// 2. ENDEREÇO IP DO ESP32\n//    Este é o IP que o ESP32 assume quando está em modo Access Point (AP).\nconst ESP32_IP_ADDRESS=\"192.168.4.1\";// ##################################################################\n// Interface para a estrutura da rota salva\nconst containerStyle={width:'100%',height:'100%'};// Adicionando uma constante para a distância de gatilho\nconst NAVIGATION_TRIGGER_DISTANCE_METERS=50;// Dispara o envio da instrução a 50 metros\nconst libraries=[\"places\"];function App(){const{isLoaded}=useJsApiLoader({id:'google-map-script',googleMapsApiKey:GOOGLE_MAPS_API_KEY,libraries});const[map,setMap]=useState(null);const[directionsResponse,setDirectionsResponse]=useState(null);const[currentPosition,setCurrentPosition]=useState(null);const[simplifiedInstructions,setSimplifiedInstructions]=useState([]);// Novos estados para gerenciar a navegação e rotas salvas\nconst[isNavigating,setIsNavigating]=useState(false);const[currentStepIndex,setCurrentStepIndex]=useState(0);const[savedRoutes,setSavedRoutes]=useState([]);const locationWatcherId=useRef(null);const destinationRef=useRef(null);useEffect(()=>{if(navigator.geolocation){navigator.geolocation.getCurrentPosition(position=>{const pos={lat:position.coords.latitude,lng:position.coords.longitude};setCurrentPosition(pos);map===null||map===void 0?void 0:map.panTo(pos);},()=>{alert(\"Erro: O serviço de geolocalização falhou.\");});}else{alert(\"Erro: Seu navegador não suporta geolocalização.\");}},[map]);// Efeito para carregar as rotas salvas do localStorage ao iniciar\nuseEffect(()=>{try{const routesFromStorage=localStorage.getItem('savedNavigationRoutes');if(routesFromStorage){setSavedRoutes(JSON.parse(routesFromStorage));}}catch(error){console.error(\"Erro ao carregar rotas do localStorage:\",error);// Opcional: Limpar dados corrompidos\n// localStorage.removeItem('savedNavigationRoutes');\n}},[]);// Nova função para calcular a distância entre dois pontos de GPS (fórmula de Haversine)\nconst getDistanceInMeters=(pos1,pos2)=>{const R=6371e3;// Metros\nconst p1=pos1.lat*Math.PI/180;const p2=pos2.lat*Math.PI/180;const deltaP=(pos2.lat-pos1.lat)*Math.PI/180;const deltaL=(pos2.lng-pos1.lng)*Math.PI/180;const a=Math.sin(deltaP/2)*Math.sin(deltaP/2)+Math.cos(p1)*Math.cos(p2)*Math.sin(deltaL/2)*Math.sin(deltaL/2);const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return R*c;// em metros\n};const calculateRoute=async()=>{var _destinationRef$curre;if(!((_destinationRef$curre=destinationRef.current)!==null&&_destinationRef$curre!==void 0&&_destinationRef$curre.value)||!currentPosition){return;}const directionsService=new google.maps.DirectionsService();const results=await directionsService.route({origin:currentPosition,destination:destinationRef.current.value,travelMode:google.maps.TravelMode.DRIVING,language:'pt-BR'// Instruções em Português\n});setDirectionsResponse(results);generateSimplifiedInstructions(results);};const generateSimplifiedInstructions=directions=>{if(!directions.routes||directions.routes.length===0){return;}const route=directions.routes[0].legs[0];const instructions=route.steps.map(step=>{var _step$distance;// Remove tags HTML da instrução (ex: <b>, <div>)\nconst cleanInstruction=step.instructions.replace(/<[^>]*>/g,'');const distance=((_step$distance=step.distance)===null||_step$distance===void 0?void 0:_step$distance.text)||'';return\"\".concat(cleanInstruction,\" (\").concat(distance,\")\");});setSimplifiedInstructions(instructions);};// Funções para gerenciar rotas salvas\nconst saveCurrentRoute=()=>{var _destinationRef$curre2;if(!directionsResponse||!((_destinationRef$curre2=destinationRef.current)!==null&&_destinationRef$curre2!==void 0&&_destinationRef$curre2.value)){alert(\"Nenhuma rota calculada para salvar.\");return;}const routeName=destinationRef.current.value;if(savedRoutes.some(route=>route.name===routeName)){if(!window.confirm(\"Uma rota para \\\"\".concat(routeName,\"\\\" j\\xE1 existe. Deseja substitu\\xED-la?\"))){return;}}const newRoute={name:routeName,directions:directionsResponse};const updatedRoutes=savedRoutes.filter(route=>route.name!==routeName);updatedRoutes.push(newRoute);setSavedRoutes(updatedRoutes);localStorage.setItem('savedNavigationRoutes',JSON.stringify(updatedRoutes));alert(\"Rota para \\\"\".concat(routeName,\"\\\" salva com sucesso!\"));};const loadSavedRoute=routeToLoad=>{setDirectionsResponse(routeToLoad.directions);generateSimplifiedInstructions(routeToLoad.directions);setIsNavigating(false);if(destinationRef.current){destinationRef.current.value=routeToLoad.name;}alert(\"Rota para \\\"\".concat(routeToLoad.name,\"\\\" carregada.\"));};const deleteSavedRoute=indexToDelete=>{if(window.confirm(\"Tem certeza que deseja deletar esta rota?\")){const updatedRoutes=savedRoutes.filter((_,index)=>index!==indexToDelete);setSavedRoutes(updatedRoutes);localStorage.setItem('savedNavigationRoutes',JSON.stringify(updatedRoutes));}};const stopNavigation=()=>{if(locationWatcherId.current!==null){navigator.geolocation.clearWatch(locationWatcherId.current);locationWatcherId.current=null;}setIsNavigating(false);alert(\"Navegação encerrada.\");};const advanceToStep=useCallback(stepIndex=>{if(!directionsResponse)return;const route=directionsResponse.routes[0].legs[0];if(stepIndex>=route.steps.length){sendSingleInstructionToESP32(\"Você chegou ao seu destino!\");stopNavigation();return;}const step=route.steps[stepIndex];const instructionText=step.instructions.replace(/<[^>]*>/g,'');sendSingleInstructionToESP32(instructionText);setCurrentStepIndex(prevIndex=>prevIndex+1);},[directionsResponse]);const sendSingleInstructionToESP32=async instruction=>{const endpoint=\"http://\".concat(ESP32_IP_ADDRESS,\"/navigate\");console.log(\"Enviando instru\\xE7\\xE3o para \".concat(endpoint,\": \").concat(instruction));try{await fetch(endpoint,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({instruction:instruction})});}catch(error){console.error(\"Erro ao enviar instrução para o ESP32:\",error);}};// Este useEffect é o cérebro da navegação em tempo real\nuseEffect(()=>{if(!isNavigating)return;const handleLocationUpdate=position=>{if(!(directionsResponse!==null&&directionsResponse!==void 0&&directionsResponse.routes[0]))return;const userPosition={lat:position.coords.latitude,lng:position.coords.longitude};setCurrentPosition(userPosition);const route=directionsResponse.routes[0].legs[0];if(currentStepIndex>=route.steps.length){advanceToStep(currentStepIndex);// Para enviar a mensagem final\nreturn;}const nextStep=route.steps[currentStepIndex];// CORREÇÃO: O objeto LatLng perde seus métodos ao ser salvo no localStorage.\n// Esta verificação lida com ambos os casos: o objeto original e o objeto recarregado.\nlet nextStepLocation;const startLocation=nextStep.start_location;if(typeof startLocation.lat==='function'){// Objeto LatLng do Google, vindo de uma rota online\nnextStepLocation={lat:startLocation.lat(),lng:startLocation.lng()};}else{// Objeto LatLngLiteral simples, vindo de uma rota salva do localStorage\n// A conversão para 'unknown' primeiro satisfaz o linter do TypeScript.\nnextStepLocation=startLocation;}const distance=getDistanceInMeters(userPosition,nextStepLocation);if(distance<NAVIGATION_TRIGGER_DISTANCE_METERS){advanceToStep(currentStepIndex);}};const handleLocationError=error=>{alert(\"Erro de geolocaliza\\xE7\\xE3o: \".concat(error.message));stopNavigation();};locationWatcherId.current=navigator.geolocation.watchPosition(handleLocationUpdate,handleLocationError,{enableHighAccuracy:true,timeout:10000,maximumAge:0});return()=>{if(locationWatcherId.current!==null){navigator.geolocation.clearWatch(locationWatcherId.current);}};},[isNavigating,currentStepIndex,directionsResponse,advanceToStep]);const startNavigation=()=>{if(!directionsResponse){alert(\"É necessário calcular uma rota antes de iniciar a navegação.\");return;}setCurrentStepIndex(0);// Envia a primeira instrução imediatamente ao iniciar\nadvanceToStep(0);setIsNavigating(true);alert(\"Iniciando navegação!\");};// Nova função para o botão de teste\nconst forceNextInstruction=()=>{advanceToStep(currentStepIndex);};if(!isLoaded){return/*#__PURE__*/_jsx(\"div\",{children:\"Carregando Mapa...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/assets/Logo_Principal.png\",alt:\"Logo\",className:\"app-logo\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"controls-container\",children:[/*#__PURE__*/_jsx(Autocomplete,{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Digite o endere\\xE7o de destino\",ref:destinationRef})}),/*#__PURE__*/_jsx(\"button\",{onClick:calculateRoute,children:\"Gerar Rota\"}),directionsResponse&&/*#__PURE__*/_jsx(\"button\",{onClick:saveCurrentRoute,className:\"save-button\",children:\"Salvar Rota\"}),!isNavigating?/*#__PURE__*/_jsx(\"button\",{onClick:startNavigation,disabled:!directionsResponse,children:\"Iniciar Navega\\xE7\\xE3o\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"navigation-controls\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:stopNavigation,className:\"stop-button\",children:\"Parar Navega\\xE7\\xE3o\"}),/*#__PURE__*/_jsx(\"button\",{onClick:forceNextInstruction,className:\"test-button\",children:\"Pr\\xF3xima (Teste)\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"instructions-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Instru\\xE7\\xF5es de Navega\\xE7\\xE3o\"}),/*#__PURE__*/_jsx(\"ul\",{children:simplifiedInstructions.map((inst,index)=>/*#__PURE__*/_jsx(\"li\",{children:inst},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"saved-routes-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Rotas Salvas (Modo Offline)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"offline-instructions\",children:[\"Para usar offline, conecte seu celular na rede Wi-Fi \",/*#__PURE__*/_jsx(\"strong\",{children:\"NAV_SYSTEM_WIFI\"}),\", carregue uma rota e inicie a navega\\xE7\\xE3o.\"]}),/*#__PURE__*/_jsx(\"ul\",{className:\"saved-routes-list\",children:savedRoutes.length>0?savedRoutes.map((route,index)=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:route.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"route-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>loadSavedRoute(route),children:\"Carregar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteSavedRoute(index),className:\"delete-button\",children:\"Deletar\"})]})]},index)):/*#__PURE__*/_jsx(\"p\",{children:\"Nenhuma rota salva.\"})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"map-container\",children:/*#__PURE__*/_jsxs(GoogleMap,{mapContainerStyle:containerStyle,center:currentPosition||{lat:-23.55052,lng:-46.633308}// Fallback to São Paulo\n,zoom:15,onLoad:map=>setMap(map),options:{disableDefaultUI:true,zoomControl:true},children:[currentPosition&&/*#__PURE__*/_jsx(Marker,{position:currentPosition}),directionsResponse&&/*#__PURE__*/_jsx(DirectionsRenderer,{directions:directionsResponse})]})})]});}export default App;","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","GoogleMap","useJsApiLoader","Marker","Autocomplete","DirectionsRenderer","jsx","_jsx","jsxs","_jsxs","GOOGLE_MAPS_API_KEY","ESP32_IP_ADDRESS","containerStyle","width","height","NAVIGATION_TRIGGER_DISTANCE_METERS","libraries","App","isLoaded","id","googleMapsApiKey","map","setMap","directionsResponse","setDirectionsResponse","currentPosition","setCurrentPosition","simplifiedInstructions","setSimplifiedInstructions","isNavigating","setIsNavigating","currentStepIndex","setCurrentStepIndex","savedRoutes","setSavedRoutes","locationWatcherId","destinationRef","navigator","geolocation","getCurrentPosition","position","pos","lat","coords","latitude","lng","longitude","panTo","alert","routesFromStorage","localStorage","getItem","JSON","parse","error","console","getDistanceInMeters","pos1","pos2","R","p1","Math","PI","p2","deltaP","deltaL","a","sin","cos","c","atan2","sqrt","calculateRoute","_destinationRef$curre","current","value","directionsService","google","maps","DirectionsService","results","route","origin","destination","travelMode","TravelMode","DRIVING","language","generateSimplifiedInstructions","directions","routes","length","legs","instructions","steps","step","_step$distance","cleanInstruction","replace","distance","text","concat","saveCurrentRoute","_destinationRef$curre2","routeName","some","name","window","confirm","newRoute","updatedRoutes","filter","push","setItem","stringify","loadSavedRoute","routeToLoad","deleteSavedRoute","indexToDelete","_","index","stopNavigation","clearWatch","advanceToStep","stepIndex","sendSingleInstructionToESP32","instructionText","prevIndex","instruction","endpoint","log","fetch","method","headers","body","handleLocationUpdate","userPosition","nextStep","nextStepLocation","startLocation","start_location","handleLocationError","message","watchPosition","enableHighAccuracy","timeout","maximumAge","startNavigation","forceNextInstruction","children","className","src","alt","type","placeholder","ref","onClick","disabled","inst","mapContainerStyle","center","zoom","onLoad","options","disableDefaultUI","zoomControl"],"sources":["C:/esp32-navigation-app/mobile-app/src/App.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { GoogleMap, useJsApiLoader, Marker, Autocomplete, DirectionsRenderer } from '@react-google-maps/api';\n\n// ##################################################################\n// # COLOQUE SUAS CHAVES E IPs AQUI                                 #\n// ##################################################################\n\n// 1. CHAVE DA API GOOGLE MAPS PLATFORM\n//    Ative as APIs: \"Maps JavaScript API\", \"Directions API\", \"Places API\"\n//    Instruções: https://developers.google.com/maps/gmp-get-started\nconst GOOGLE_MAPS_API_KEY = \"AIzaSyAVEzH5bvFPDpgjQtnA4s2TKfjEW_0OTLY\";\n\n// 2. ENDEREÇO IP DO ESP32\n//    Este é o IP que o ESP32 assume quando está em modo Access Point (AP).\nconst ESP32_IP_ADDRESS = \"192.168.4.1\";\n\n// ##################################################################\n\n// Interface para a estrutura da rota salva\ninterface SavedRoute {\n  name: string;\n  directions: google.maps.DirectionsResult;\n}\n\nconst containerStyle = {\n  width: '100%',\n  height: '100%'\n};\n\n// Adicionando uma constante para a distância de gatilho\nconst NAVIGATION_TRIGGER_DISTANCE_METERS = 50; // Dispara o envio da instrução a 50 metros\n\nconst libraries: \"places\"[] = [\"places\"];\n\nfunction App() {\n  const { isLoaded } = useJsApiLoader({\n    id: 'google-map-script',\n    googleMapsApiKey: GOOGLE_MAPS_API_KEY,\n    libraries,\n  });\n\n  const [map, setMap] = useState<google.maps.Map | null>(null);\n  const [directionsResponse, setDirectionsResponse] = useState<google.maps.DirectionsResult | null>(null);\n  const [currentPosition, setCurrentPosition] = useState<google.maps.LatLngLiteral | null>(null);\n  const [simplifiedInstructions, setSimplifiedInstructions] = useState<string[]>([]);\n  \n  // Novos estados para gerenciar a navegação e rotas salvas\n  const [isNavigating, setIsNavigating] = useState(false);\n  const [currentStepIndex, setCurrentStepIndex] = useState(0);\n  const [savedRoutes, setSavedRoutes] = useState<SavedRoute[]>([]);\n  const locationWatcherId = useRef<number | null>(null);\n  \n  const destinationRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(\n        (position) => {\n          const pos = {\n            lat: position.coords.latitude,\n            lng: position.coords.longitude,\n          };\n          setCurrentPosition(pos);\n          map?.panTo(pos);\n        },\n        () => {\n          alert(\"Erro: O serviço de geolocalização falhou.\");\n        }\n      );\n    } else {\n      alert(\"Erro: Seu navegador não suporta geolocalização.\");\n    }\n  }, [map]);\n\n  // Efeito para carregar as rotas salvas do localStorage ao iniciar\n  useEffect(() => {\n    try {\n      const routesFromStorage = localStorage.getItem('savedNavigationRoutes');\n      if (routesFromStorage) {\n        setSavedRoutes(JSON.parse(routesFromStorage));\n      }\n    } catch (error) {\n      console.error(\"Erro ao carregar rotas do localStorage:\", error);\n      // Opcional: Limpar dados corrompidos\n      // localStorage.removeItem('savedNavigationRoutes');\n    }\n  }, []);\n\n  // Nova função para calcular a distância entre dois pontos de GPS (fórmula de Haversine)\n  const getDistanceInMeters = (pos1: google.maps.LatLngLiteral, pos2: google.maps.LatLngLiteral) => {\n    const R = 6371e3; // Metros\n    const p1 = (pos1.lat * Math.PI) / 180;\n    const p2 = (pos2.lat * Math.PI) / 180;\n    const deltaP = ((pos2.lat - pos1.lat) * Math.PI) / 180;\n    const deltaL = ((pos2.lng - pos1.lng) * Math.PI) / 180;\n    const a =\n      Math.sin(deltaP / 2) * Math.sin(deltaP / 2) +\n      Math.cos(p1) * Math.cos(p2) * Math.sin(deltaL / 2) * Math.sin(deltaL / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c; // em metros\n  };\n\n  const calculateRoute = async () => {\n    if (!destinationRef.current?.value || !currentPosition) {\n      return;\n    }\n    \n    const directionsService = new google.maps.DirectionsService();\n    const results = await directionsService.route({\n      origin: currentPosition,\n      destination: destinationRef.current.value,\n      travelMode: google.maps.TravelMode.DRIVING,\n      language: 'pt-BR', // Instruções em Português\n    });\n\n    setDirectionsResponse(results);\n    generateSimplifiedInstructions(results);\n  };\n  \n  const generateSimplifiedInstructions = (directions: google.maps.DirectionsResult) => {\n    if (!directions.routes || directions.routes.length === 0) {\n      return;\n    }\n    const route = directions.routes[0].legs[0];\n    const instructions = route.steps.map((step: google.maps.DirectionsStep) => {\n      // Remove tags HTML da instrução (ex: <b>, <div>)\n      const cleanInstruction = step.instructions.replace(/<[^>]*>/g, '');\n      const distance = step.distance?.text || '';\n      return `${cleanInstruction} (${distance})`;\n    });\n    setSimplifiedInstructions(instructions);\n  };\n\n  // Funções para gerenciar rotas salvas\n  const saveCurrentRoute = () => {\n    if (!directionsResponse || !destinationRef.current?.value) {\n      alert(\"Nenhuma rota calculada para salvar.\");\n      return;\n    }\n\n    const routeName = destinationRef.current.value;\n\n    if (savedRoutes.some(route => route.name === routeName)) {\n      if (!window.confirm(`Uma rota para \"${routeName}\" já existe. Deseja substituí-la?`)) {\n        return;\n      }\n    }\n\n    const newRoute: SavedRoute = { name: routeName, directions: directionsResponse };\n    const updatedRoutes = savedRoutes.filter(route => route.name !== routeName);\n    updatedRoutes.push(newRoute);\n\n    setSavedRoutes(updatedRoutes);\n    localStorage.setItem('savedNavigationRoutes', JSON.stringify(updatedRoutes));\n    alert(`Rota para \"${routeName}\" salva com sucesso!`);\n  };\n\n  const loadSavedRoute = (routeToLoad: SavedRoute) => {\n    setDirectionsResponse(routeToLoad.directions);\n    generateSimplifiedInstructions(routeToLoad.directions);\n    setIsNavigating(false);\n    if (destinationRef.current) {\n        destinationRef.current.value = routeToLoad.name;\n    }\n    alert(`Rota para \"${routeToLoad.name}\" carregada.`);\n  };\n\n  const deleteSavedRoute = (indexToDelete: number) => {\n    if (window.confirm(\"Tem certeza que deseja deletar esta rota?\")) {\n      const updatedRoutes = savedRoutes.filter((_, index) => index !== indexToDelete);\n      setSavedRoutes(updatedRoutes);\n      localStorage.setItem('savedNavigationRoutes', JSON.stringify(updatedRoutes));\n    }\n  };\n\n  const stopNavigation = () => {\n    if (locationWatcherId.current !== null) {\n      navigator.geolocation.clearWatch(locationWatcherId.current);\n      locationWatcherId.current = null;\n    }\n    setIsNavigating(false);\n    alert(\"Navegação encerrada.\");\n  };\n\n  const advanceToStep = useCallback((stepIndex: number) => {\n    if (!directionsResponse) return;\n    const route = directionsResponse.routes[0].legs[0];\n    if (stepIndex >= route.steps.length) {\n      sendSingleInstructionToESP32(\"Você chegou ao seu destino!\");\n      stopNavigation();\n      return;\n    }\n    const step = route.steps[stepIndex];\n    const instructionText = step.instructions.replace(/<[^>]*>/g, '');\n    sendSingleInstructionToESP32(instructionText);\n    setCurrentStepIndex(prevIndex => prevIndex + 1);\n  }, [directionsResponse]);\n\n  const sendSingleInstructionToESP32 = async (instruction: string) => {\n    const endpoint = `http://${ESP32_IP_ADDRESS}/navigate`;\n    console.log(`Enviando instrução para ${endpoint}: ${instruction}`);\n    try {\n      await fetch(endpoint, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ instruction: instruction }),\n      });\n    } catch (error) {\n      console.error(\"Erro ao enviar instrução para o ESP32:\", error);\n    }\n  };\n  \n  // Este useEffect é o cérebro da navegação em tempo real\n  useEffect(() => {\n    if (!isNavigating) return;\n\n    const handleLocationUpdate = (position: GeolocationPosition) => {\n      if (!directionsResponse?.routes[0]) return;\n      const userPosition: google.maps.LatLngLiteral = {\n        lat: position.coords.latitude,\n        lng: position.coords.longitude,\n      };\n      setCurrentPosition(userPosition);\n      const route = directionsResponse.routes[0].legs[0];\n      if (currentStepIndex >= route.steps.length) {\n        advanceToStep(currentStepIndex); // Para enviar a mensagem final\n        return;\n      }\n      const nextStep = route.steps[currentStepIndex];\n      \n      // CORREÇÃO: O objeto LatLng perde seus métodos ao ser salvo no localStorage.\n      // Esta verificação lida com ambos os casos: o objeto original e o objeto recarregado.\n      let nextStepLocation: google.maps.LatLngLiteral;\n      const startLocation = nextStep.start_location;\n\n      if (typeof startLocation.lat === 'function') {\n        // Objeto LatLng do Google, vindo de uma rota online\n        nextStepLocation = { lat: startLocation.lat(), lng: startLocation.lng() };\n      } else {\n        // Objeto LatLngLiteral simples, vindo de uma rota salva do localStorage\n        // A conversão para 'unknown' primeiro satisfaz o linter do TypeScript.\n        nextStepLocation = startLocation as unknown as google.maps.LatLngLiteral;\n      }\n\n      const distance = getDistanceInMeters(userPosition, nextStepLocation);\n      if (distance < NAVIGATION_TRIGGER_DISTANCE_METERS) {\n        advanceToStep(currentStepIndex);\n      }\n    };\n\n    const handleLocationError = (error: GeolocationPositionError) => {\n      alert(`Erro de geolocalização: ${error.message}`);\n      stopNavigation();\n    };\n\n    locationWatcherId.current = navigator.geolocation.watchPosition(\n      handleLocationUpdate, handleLocationError,\n      { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\n    );\n\n    return () => {\n      if (locationWatcherId.current !== null) {\n        navigator.geolocation.clearWatch(locationWatcherId.current);\n      }\n    };\n  }, [isNavigating, currentStepIndex, directionsResponse, advanceToStep]);\n\n\n  const startNavigation = () => {\n    if (!directionsResponse) {\n      alert(\"É necessário calcular uma rota antes de iniciar a navegação.\");\n      return;\n    }\n    setCurrentStepIndex(0);\n    // Envia a primeira instrução imediatamente ao iniciar\n    advanceToStep(0); \n    setIsNavigating(true);\n    alert(\"Iniciando navegação!\");\n  };\n\n  // Nova função para o botão de teste\n  const forceNextInstruction = () => {\n    advanceToStep(currentStepIndex);\n  };\n\n  if (!isLoaded) {\n    return <div>Carregando Mapa...</div>;\n  }\n\n  return (\n    <div className=\"App\">\n      <div className=\"sidebar\">\n        <img src=\"/assets/Logo_Principal.png\" alt=\"Logo\" className=\"app-logo\" />\n        \n        <div className=\"controls-container\">\n          <Autocomplete>\n            <input\n              type='text'\n              placeholder='Digite o endereço de destino'\n              ref={destinationRef}\n            />\n          </Autocomplete>\n          <button onClick={calculateRoute}>Gerar Rota</button>\n          \n          {directionsResponse && (\n            <button onClick={saveCurrentRoute} className=\"save-button\">\n              Salvar Rota\n            </button>\n          )}\n\n          {!isNavigating ? (\n            <button onClick={startNavigation} disabled={!directionsResponse}>\n              Iniciar Navegação\n            </button>\n          ) : (\n            <div className=\"navigation-controls\">\n              <button onClick={stopNavigation} className=\"stop-button\">\n                Parar Navegação\n              </button>\n              <button onClick={forceNextInstruction} className=\"test-button\">\n                Próxima (Teste)\n              </button>\n            </div>\n          )}\n        </div>\n\n        <div className=\"instructions-container\">\n          <h3>Instruções de Navegação</h3>\n          <ul>\n            {simplifiedInstructions.map((inst, index) => (\n              <li key={index}>{inst}</li>\n            ))}\n          </ul>\n        </div>\n\n        {/* Nova seção para Rotas Salvas */}\n        <div className=\"saved-routes-container\">\n          <h3>Rotas Salvas (Modo Offline)</h3>\n          <p className=\"offline-instructions\">\n            Para usar offline, conecte seu celular na rede Wi-Fi <strong>NAV_SYSTEM_WIFI</strong>, carregue uma rota e inicie a navegação.\n          </p>\n          <ul className=\"saved-routes-list\">\n            {savedRoutes.length > 0 ? (\n              savedRoutes.map((route, index) => (\n                <li key={index}>\n                  <span>{route.name}</span>\n                  <div className=\"route-actions\">\n                    <button onClick={() => loadSavedRoute(route)}>Carregar</button>\n                    <button onClick={() => deleteSavedRoute(index)} className=\"delete-button\">Deletar</button>\n                  </div>\n                </li>\n              ))\n            ) : (\n              <p>Nenhuma rota salva.</p>\n            )}\n          </ul>\n        </div>\n      </div>\n\n      <div className=\"map-container\">\n        <GoogleMap\n          mapContainerStyle={containerStyle}\n          center={currentPosition || { lat: -23.55052, lng: -46.633308 }} // Fallback to São Paulo\n          zoom={15}\n          onLoad={(map: google.maps.Map) => setMap(map)}\n          options={{disableDefaultUI: true, zoomControl: true}}\n        >\n          {currentPosition && <Marker position={currentPosition} />}\n          {directionsResponse && <DirectionsRenderer directions={directionsResponse} />}\n        </GoogleMap>\n      </div>\n    </div>\n  );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}