{"ast":null,"code":"import React,{useState,useRef,useEffect,useCallback}from'react';import{GoogleMap,useJsApiLoader,Marker,Autocomplete,DirectionsRenderer}from'@react-google-maps/api';// Defini√ß√µes de tipos para Web Bluetooth API\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";// ##################################################################\n// # COLOQUE SUAS CHAVES AQUI                                       #\n// ##################################################################\n// 1. CHAVE DA API GOOGLE MAPS PLATFORM\n//    Ative as APIs: \"Maps JavaScript API\", \"Directions API\", \"Places API\"\n//    Instru√ß√µes: https://developers.google.com/maps/gmp-get-started\nconst GOOGLE_MAPS_API_KEY=\"AIzaSyAVEzH5bvFPDpgjQtnA4s2TKfjEW_0OTLY\";// 2. CONFIGURA√á√ïES BLUETOOTH\n//    Nome do dispositivo ESP32 que aparecer√° na lista de dispositivos Bluetooth\nconst ESP32_DEVICE_NAME=\"ESP32_Navigation\";// Altere para o nome do seu ESP32\nconst ESP32_SERVICE_UUID=\"0000ffe0-0000-1000-8000-00805f9b34fb\";// UUID do servi√ßo\nconst ESP32_CHARACTERISTIC_UUID=\"0000ffe1-0000-1000-8000-00805f9b34fb\";// UUID da caracter√≠stica\n// ##################################################################\n// Interface para a estrutura da rota salva\n// Interface para dispositivo Bluetooth\nconst containerStyle={width:'100%',height:'100%'};// Adicionando uma constante para a dist√¢ncia de gatilho\nconst NAVIGATION_TRIGGER_DISTANCE_METERS=50;// Dispara o envio da instru√ß√£o a 50 metros\nconst libraries=[\"places\"];function App(){const{isLoaded}=useJsApiLoader({id:'google-map-script',googleMapsApiKey:GOOGLE_MAPS_API_KEY,libraries});const[map,setMap]=useState(null);const[directionsResponse,setDirectionsResponse]=useState(null);const[currentPosition,setCurrentPosition]=useState(null);const[simplifiedInstructions,setSimplifiedInstructions]=useState([]);// Novos estados para gerenciar a navega√ß√£o e rotas salvas\nconst[isNavigating,setIsNavigating]=useState(false);const[currentStepIndex,setCurrentStepIndex]=useState(0);const[savedRoutes,setSavedRoutes]=useState([]);const locationWatcherId=useRef(null);// Novo estado para o modo offline\nconst[isOnline,setIsOnline]=useState(navigator.onLine);// Estados para Bluetooth\nconst[isBluetoothConnected,setIsBluetoothConnected]=useState(false);const[bluetoothDevice,setBluetoothDevice]=useState(null);const[bluetoothCharacteristic,setBluetoothCharacteristic]=useState(null);const[isConnectingBluetooth,setIsConnectingBluetooth]=useState(false);const destinationRef=useRef(null);// Verificar se o navegador suporta Web Bluetooth\nconst isBluetoothSupported=()=>{return'bluetooth'in navigator;};// Fun√ß√£o para conectar ao ESP32 via Bluetooth\nconst connectToESP32=async()=>{if(!isBluetoothSupported()||!navigator.bluetooth){alert(\"Seu navegador n√£o suporta Web Bluetooth. Use Chrome ou Edge.\");return;}setIsConnectingBluetooth(true);try{var _device$gatt;// Solicitar dispositivo Bluetooth\nconst device=await navigator.bluetooth.requestDevice({filters:[{name:ESP32_DEVICE_NAME},{namePrefix:\"ESP32\"}],optionalServices:[ESP32_SERVICE_UUID]});console.log(\"Dispositivo selecionado:\",device.name);// Conectar ao GATT Server\nconst server=await((_device$gatt=device.gatt)===null||_device$gatt===void 0?void 0:_device$gatt.connect());if(!server){throw new Error(\"N√£o foi poss√≠vel conectar ao servidor GATT\");}// Obter o servi√ßo\nconst service=await server.getPrimaryService(ESP32_SERVICE_UUID);// Obter a caracter√≠stica para escrita\nconst characteristic=await service.getCharacteristic(ESP32_CHARACTERISTIC_UUID);// Habilitar notifica√ß√µes se dispon√≠vel\ntry{await characteristic.startNotifications();characteristic.addEventListener('characteristicvaluechanged',event=>{const target=event.target;const value=target.value;if(value){const decoder=new TextDecoder();const message=decoder.decode(value);console.log(\"Mensagem recebida do ESP32:\",message);}});}catch(error){console.log(\"Notifica√ß√µes n√£o dispon√≠veis, apenas escrita\");}setBluetoothDevice({id:device.id,name:device.name||ESP32_DEVICE_NAME,gatt:server});setBluetoothCharacteristic(characteristic);setIsBluetoothConnected(true);console.log(\"Conectado ao ESP32 via Bluetooth!\");alert(\"Conectado ao ESP32 via Bluetooth!\");}catch(error){console.error(\"Erro ao conectar Bluetooth:\",error);if(error instanceof Error){if(error.name==='NotFoundError'){alert(\"ESP32 n√£o encontrado. Verifique se est√° ligado e vis√≠vel.\");}else if(error.name==='NotAllowedError'){alert(\"Permiss√£o negada para Bluetooth.\");}else{alert(\"Erro de conex\\xE3o: \".concat(error.message));}}else{alert(\"Erro desconhecido ao conectar Bluetooth.\");}}finally{setIsConnectingBluetooth(false);}};// Fun√ß√£o para desconectar Bluetooth\nconst disconnectBluetooth=async()=>{var _bluetoothDevice$gatt;if(bluetoothDevice!==null&&bluetoothDevice!==void 0&&(_bluetoothDevice$gatt=bluetoothDevice.gatt)!==null&&_bluetoothDevice$gatt!==void 0&&_bluetoothDevice$gatt.connected){await bluetoothDevice.gatt.disconnect();}setBluetoothDevice(null);setBluetoothCharacteristic(null);setIsBluetoothConnected(false);console.log(\"Desconectado do ESP32\");};// Fun√ß√£o para enviar instru√ß√£o via Bluetooth\nconst sendInstructionViaBluetooth=async instruction=>{if(!bluetoothCharacteristic||!isBluetoothConnected){console.error(\"Bluetooth n√£o conectado\");return;}try{const encoder=new TextEncoder();const data=encoder.encode(instruction+'\\n');// Adiciona quebra de linha\nawait bluetoothCharacteristic.writeValue(data);console.log(\"Instru\\xE7\\xE3o enviada via Bluetooth: \".concat(instruction));}catch(error){console.error(\"Erro ao enviar via Bluetooth:\",error);alert(\"Erro ao enviar instru√ß√£o via Bluetooth. Verifique a conex√£o.\");}};// Fun√ß√£o para enviar instru√ß√£o (agora usa Bluetooth em vez de HTTP)\nconst sendSingleInstructionToESP32=async instruction=>{if(isBluetoothConnected){await sendInstructionViaBluetooth(instruction);}else{console.log(\"Bluetooth n√£o conectado. Instru√ß√£o n√£o enviada.\");alert(\"Conecte ao ESP32 via Bluetooth primeiro.\");}};useEffect(()=>{if(navigator.geolocation){navigator.geolocation.getCurrentPosition(position=>{const pos={lat:position.coords.latitude,lng:position.coords.longitude};setCurrentPosition(pos);map===null||map===void 0?void 0:map.panTo(pos);},()=>{alert(\"Erro: O servi√ßo de geolocaliza√ß√£o falhou.\");});}else{alert(\"Erro: Seu navegador n√£o suporta geolocaliza√ß√£o.\");}},[map]);// Efeito para monitorar o status da conex√£o (online/offline)\nuseEffect(()=>{const handleOnline=()=>setIsOnline(true);const handleOffline=()=>setIsOnline(false);window.addEventListener('online',handleOnline);window.addEventListener('offline',handleOffline);return()=>{window.removeEventListener('online',handleOnline);window.removeEventListener('offline',handleOffline);};},[]);// Efeito para carregar as rotas salvas do localStorage ao iniciar\nuseEffect(()=>{try{const routesFromStorage=localStorage.getItem('savedNavigationRoutes');if(routesFromStorage){setSavedRoutes(JSON.parse(routesFromStorage));}}catch(error){console.error(\"Erro ao carregar rotas do localStorage:\",error);// Opcional: Limpar dados corrompidos\n// localStorage.removeItem('savedNavigationRoutes');\n}},[]);// Nova fun√ß√£o para calcular a dist√¢ncia entre dois pontos de GPS (f√≥rmula de Haversine)\nconst getDistanceInMeters=(pos1,pos2)=>{const R=6371e3;// Metros\nconst p1=pos1.lat*Math.PI/180;const p2=pos2.lat*Math.PI/180;const deltaP=(pos2.lat-pos1.lat)*Math.PI/180;const deltaL=(pos2.lng-pos1.lng)*Math.PI/180;const a=Math.sin(deltaP/2)*Math.sin(deltaP/2)+Math.cos(p1)*Math.cos(p2)*Math.sin(deltaL/2)*Math.sin(deltaL/2);const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return R*c;// em metros\n};const calculateRoute=async()=>{var _destinationRef$curre;if(!isOnline){alert(\"Funcionalidade indispon√≠vel offline. Carregue uma rota salva.\");return;}if(!((_destinationRef$curre=destinationRef.current)!==null&&_destinationRef$curre!==void 0&&_destinationRef$curre.value)||!currentPosition){return;}const directionsService=new google.maps.DirectionsService();const results=await directionsService.route({origin:currentPosition,destination:destinationRef.current.value,travelMode:google.maps.TravelMode.DRIVING,language:'pt-BR'// Instru√ß√µes em Portugu√™s\n});setDirectionsResponse(results);generateSimplifiedInstructions(results);};const generateSimplifiedInstructions=directions=>{if(!directions.routes||directions.routes.length===0){return;}const route=directions.routes[0].legs[0];const instructions=route.steps.map(step=>{var _step$distance;// Remove tags HTML da instru√ß√£o (ex: <b>, <div>)\nconst cleanInstruction=step.instructions.replace(/<[^>]*>/g,'');const distance=((_step$distance=step.distance)===null||_step$distance===void 0?void 0:_step$distance.text)||'';return\"\".concat(cleanInstruction,\" (\").concat(distance,\")\");});setSimplifiedInstructions(instructions);};// Fun√ß√µes para gerenciar rotas salvas\nconst saveCurrentRoute=()=>{var _destinationRef$curre2;if(!isOnline){alert(\"Funcionalidade indispon√≠vel offline.\");return;}if(!directionsResponse||!((_destinationRef$curre2=destinationRef.current)!==null&&_destinationRef$curre2!==void 0&&_destinationRef$curre2.value)){alert(\"Nenhuma rota calculada para salvar.\");return;}const routeName=destinationRef.current.value;if(savedRoutes.some(route=>route.name===routeName)){if(!window.confirm(\"Uma rota para \\\"\".concat(routeName,\"\\\" j\\xE1 existe. Deseja substitu\\xED-la?\"))){return;}}const newRoute={name:routeName,directions:directionsResponse};const updatedRoutes=savedRoutes.filter(route=>route.name!==routeName);updatedRoutes.push(newRoute);setSavedRoutes(updatedRoutes);localStorage.setItem('savedNavigationRoutes',JSON.stringify(updatedRoutes));alert(\"Rota para \\\"\".concat(routeName,\"\\\" salva com sucesso!\"));};const loadSavedRoute=routeToLoad=>{setDirectionsResponse(routeToLoad.directions);generateSimplifiedInstructions(routeToLoad.directions);setIsNavigating(false);if(destinationRef.current){destinationRef.current.value=routeToLoad.name;}alert(\"Rota para \\\"\".concat(routeToLoad.name,\"\\\" carregada.\"));};const deleteSavedRoute=indexToDelete=>{if(window.confirm(\"Tem certeza que deseja deletar esta rota?\")){const updatedRoutes=savedRoutes.filter((_,index)=>index!==indexToDelete);setSavedRoutes(updatedRoutes);localStorage.setItem('savedNavigationRoutes',JSON.stringify(updatedRoutes));}};const stopNavigation=()=>{if(locationWatcherId.current!==null){navigator.geolocation.clearWatch(locationWatcherId.current);locationWatcherId.current=null;}setIsNavigating(false);alert(\"Navega√ß√£o encerrada.\");};const advanceToStep=useCallback(stepIndex=>{if(!directionsResponse)return;const route=directionsResponse.routes[0].legs[0];if(stepIndex>=route.steps.length){sendSingleInstructionToESP32(\"Voc√™ chegou ao seu destino!\");stopNavigation();return;}const step=route.steps[stepIndex];const instructionText=step.instructions.replace(/<[^>]*>/g,'');sendSingleInstructionToESP32(instructionText);setCurrentStepIndex(prevIndex=>prevIndex+1);},[directionsResponse]);const handleLocationUpdate=useCallback(position=>{if(!(directionsResponse!==null&&directionsResponse!==void 0&&directionsResponse.routes[0]))return;const userPosition={lat:position.coords.latitude,lng:position.coords.longitude};setCurrentPosition(userPosition);const route=directionsResponse.routes[0].legs[0];if(currentStepIndex>=route.steps.length){advanceToStep(currentStepIndex);// Para enviar a mensagem final\nreturn;}const nextStep=route.steps[currentStepIndex];let nextStepLocation;const startLocation=nextStep.start_location;if(typeof startLocation.lat==='function'){nextStepLocation={lat:startLocation.lat(),lng:startLocation.lng()};}else{nextStepLocation=startLocation;}const distance=getDistanceInMeters(userPosition,nextStepLocation);if(distance<NAVIGATION_TRIGGER_DISTANCE_METERS){advanceToStep(currentStepIndex);}},[directionsResponse,currentStepIndex,advanceToStep,getDistanceInMeters]);const handleLocationError=useCallback(error=>{alert(\"Erro de geolocaliza\\xE7\\xE3o: \".concat(error.message));stopNavigation();},[]);// Este useEffect √© o c√©rebro da navega√ß√£o em tempo real\nuseEffect(()=>{if(!isNavigating){return;}locationWatcherId.current=navigator.geolocation.watchPosition(handleLocationUpdate,handleLocationError,{enableHighAccuracy:true,timeout:10000,maximumAge:0});return()=>{if(locationWatcherId.current!==null){navigator.geolocation.clearWatch(locationWatcherId.current);}};},[isNavigating,handleLocationUpdate,handleLocationError]);const startNavigation=()=>{if(!directionsResponse){alert(\"Carregue uma rota primeiro.\");return;}stopNavigation();// Garante que qualquer watch anterior seja limpo\nsetCurrentStepIndex(0);setIsNavigating(true);alert(\"Iniciando a navega√ß√£o!\");};const forceNextInstruction=()=>{if(!isNavigating){alert(\"A navega√ß√£o n√£o est√° ativa.\");return;}advanceToStep(currentStepIndex);};if(!isLoaded)return/*#__PURE__*/_jsx(\"div\",{children:\"Carregando...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo-container\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/assets/Logo_Principal.png\",alt:\"Logo\",className:\"logo-img\"})}),!isOnline&&/*#__PURE__*/_jsx(\"div\",{className:\"offline-banner\",children:/*#__PURE__*/_jsx(\"p\",{children:\"MODO OFFLINE ATIVO\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bluetooth-controls\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDD35 Conex\\xE3o Bluetooth\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bluetooth-status\",children:isBluetoothConnected?/*#__PURE__*/_jsxs(\"div\",{className:\"connected-status\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"status-indicator connected\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Conectado: \",bluetoothDevice===null||bluetoothDevice===void 0?void 0:bluetoothDevice.name]}),/*#__PURE__*/_jsx(\"button\",{className:\"button disconnect-btn\",onClick:disconnectBluetooth,children:\"Desconectar\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"disconnected-status\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"status-indicator disconnected\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Desconectado\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button connect-btn\",onClick:connectToESP32,disabled:isConnectingBluetooth,children:isConnectingBluetooth?'Conectando...':'Conectar ESP32'})]})}),!isBluetoothSupported()&&/*#__PURE__*/_jsx(\"div\",{className:\"bluetooth-warning\",children:\"\\u26A0\\uFE0F Seu navegador n\\xE3o suporta Web Bluetooth. Use Chrome ou Edge.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"controls-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Navega\\xE7\\xE3o Ponto a Ponto\"}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(Autocomplete,{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Destino\",ref:destinationRef,disabled:!isOnline})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"button-group\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:calculateRoute,disabled:!isOnline,children:\"Obter Rota\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:saveCurrentRoute,disabled:!isOnline,children:\"Salvar Rota Atual\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"navigation-controls\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Controle de Navega\\xE7\\xE3o\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"button-group\",children:[!isNavigating?/*#__PURE__*/_jsx(\"button\",{onClick:startNavigation,className:\"button start-nav-btn\",disabled:!directionsResponse,children:\"Iniciar Navega\\xE7\\xE3o\"}):/*#__PURE__*/_jsx(\"button\",{onClick:stopNavigation,className:\"button stop-nav-btn\",children:\"Parar Navega\\xE7\\xE3o\"}),/*#__PURE__*/_jsx(\"button\",{onClick:forceNextInstruction,className:\"button\",disabled:!isNavigating,children:\"Pr\\xF3xima Instru\\xE7\\xE3o (Teste)\"})]}),isNavigating&&/*#__PURE__*/_jsxs(\"p\",{className:\"nav-status\",children:[\"Navega\\xE7\\xE3o em curso... Pr\\xF3ximo passo: \",currentStepIndex+1]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"saved-routes-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Rotas Salvas\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"route-list\",children:savedRoutes.length>0?savedRoutes.map((route,index)=>/*#__PURE__*/_jsxs(\"li\",{className:\"route-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:route.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"route-item-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>loadSavedRoute(route),children:\"Carregar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteSavedRoute(index),className:\"delete-btn\",children:\"X\"})]})]},index)):/*#__PURE__*/_jsx(\"p\",{children:\"Nenhuma rota salva.\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"instructions-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Instru\\xE7\\xF5es\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"instructions-list\",children:simplifiedInstructions.map((inst,index)=>/*#__PURE__*/_jsx(\"li\",{className:index===currentStepIndex-1?'current-instruction':'',children:inst},index))})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"map-container\",children:isOnline?/*#__PURE__*/_jsxs(GoogleMap,{mapContainerStyle:containerStyle,center:currentPosition||{lat:-23.55052,lng:-46.633308},zoom:15,onLoad:setMap,options:{mapTypeControl:false,streetViewControl:false,fullscreenControl:false},children:[directionsResponse&&/*#__PURE__*/_jsx(DirectionsRenderer,{directions:directionsResponse}),currentPosition&&/*#__PURE__*/_jsx(Marker,{position:currentPosition})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"offline-map-placeholder\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Mapa indispon\\xEDvel em modo offline\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Use as rotas salvas para navegar. A sua localiza\\xE7\\xE3o continua sendo rastreada.\"})]})})]});}export default App;","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","GoogleMap","useJsApiLoader","Marker","Autocomplete","DirectionsRenderer","jsx","_jsx","jsxs","_jsxs","GOOGLE_MAPS_API_KEY","ESP32_DEVICE_NAME","ESP32_SERVICE_UUID","ESP32_CHARACTERISTIC_UUID","containerStyle","width","height","NAVIGATION_TRIGGER_DISTANCE_METERS","libraries","App","isLoaded","id","googleMapsApiKey","map","setMap","directionsResponse","setDirectionsResponse","currentPosition","setCurrentPosition","simplifiedInstructions","setSimplifiedInstructions","isNavigating","setIsNavigating","currentStepIndex","setCurrentStepIndex","savedRoutes","setSavedRoutes","locationWatcherId","isOnline","setIsOnline","navigator","onLine","isBluetoothConnected","setIsBluetoothConnected","bluetoothDevice","setBluetoothDevice","bluetoothCharacteristic","setBluetoothCharacteristic","isConnectingBluetooth","setIsConnectingBluetooth","destinationRef","isBluetoothSupported","connectToESP32","bluetooth","alert","_device$gatt","device","requestDevice","filters","name","namePrefix","optionalServices","console","log","server","gatt","connect","Error","service","getPrimaryService","characteristic","getCharacteristic","startNotifications","addEventListener","event","target","value","decoder","TextDecoder","message","decode","error","concat","disconnectBluetooth","_bluetoothDevice$gatt","connected","disconnect","sendInstructionViaBluetooth","instruction","encoder","TextEncoder","data","encode","writeValue","sendSingleInstructionToESP32","geolocation","getCurrentPosition","position","pos","lat","coords","latitude","lng","longitude","panTo","handleOnline","handleOffline","window","removeEventListener","routesFromStorage","localStorage","getItem","JSON","parse","getDistanceInMeters","pos1","pos2","R","p1","Math","PI","p2","deltaP","deltaL","a","sin","cos","c","atan2","sqrt","calculateRoute","_destinationRef$curre","current","directionsService","google","maps","DirectionsService","results","route","origin","destination","travelMode","TravelMode","DRIVING","language","generateSimplifiedInstructions","directions","routes","length","legs","instructions","steps","step","_step$distance","cleanInstruction","replace","distance","text","saveCurrentRoute","_destinationRef$curre2","routeName","some","confirm","newRoute","updatedRoutes","filter","push","setItem","stringify","loadSavedRoute","routeToLoad","deleteSavedRoute","indexToDelete","_","index","stopNavigation","clearWatch","advanceToStep","stepIndex","instructionText","prevIndex","handleLocationUpdate","userPosition","nextStep","nextStepLocation","startLocation","start_location","handleLocationError","watchPosition","enableHighAccuracy","timeout","maximumAge","startNavigation","forceNextInstruction","children","className","src","alt","onClick","disabled","type","placeholder","ref","inst","mapContainerStyle","center","zoom","onLoad","options","mapTypeControl","streetViewControl","fullscreenControl"],"sources":["C:/esp32-navigation-app/mobile-app/src/App.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { GoogleMap, useJsApiLoader, Marker, Autocomplete, DirectionsRenderer } from '@react-google-maps/api';\n\n// Defini√ß√µes de tipos para Web Bluetooth API\ndeclare global {\n  interface Navigator {\n    bluetooth?: Bluetooth;\n  }\n  \n  interface Bluetooth {\n    requestDevice(options: RequestDeviceOptions): Promise<BluetoothDevice>;\n  }\n  \n  interface RequestDeviceOptions {\n    filters?: BluetoothLEScanFilter[];\n    optionalServices?: string[];\n  }\n  \n  interface BluetoothLEScanFilter {\n    name?: string;\n    namePrefix?: string;\n    services?: string[];\n  }\n  \n  interface BluetoothDevice {\n    id: string;\n    name?: string;\n    gatt?: BluetoothRemoteGATTServer;\n  }\n  \n  interface BluetoothRemoteGATTServer {\n    connect(): Promise<BluetoothRemoteGATTServer>;\n    getPrimaryService(service: string): Promise<BluetoothRemoteGATTService>;\n    connected: boolean;\n    disconnect(): void;\n  }\n  \n  interface BluetoothRemoteGATTService {\n    getCharacteristic(characteristic: string): Promise<BluetoothRemoteGATTCharacteristic>;\n  }\n  \n  interface BluetoothRemoteGATTCharacteristic {\n    writeValue(value: BufferSource): Promise<void>;\n    startNotifications(): Promise<BluetoothRemoteGATTCharacteristic>;\n    addEventListener(type: string, listener: EventListener): void;\n    value?: DataView;\n  }\n}\n\n// ##################################################################\n// # COLOQUE SUAS CHAVES AQUI                                       #\n// ##################################################################\n\n// 1. CHAVE DA API GOOGLE MAPS PLATFORM\n//    Ative as APIs: \"Maps JavaScript API\", \"Directions API\", \"Places API\"\n//    Instru√ß√µes: https://developers.google.com/maps/gmp-get-started\nconst GOOGLE_MAPS_API_KEY = \"AIzaSyAVEzH5bvFPDpgjQtnA4s2TKfjEW_0OTLY\";\n\n// 2. CONFIGURA√á√ïES BLUETOOTH\n//    Nome do dispositivo ESP32 que aparecer√° na lista de dispositivos Bluetooth\nconst ESP32_DEVICE_NAME = \"ESP32_Navigation\"; // Altere para o nome do seu ESP32\nconst ESP32_SERVICE_UUID = \"0000ffe0-0000-1000-8000-00805f9b34fb\"; // UUID do servi√ßo\nconst ESP32_CHARACTERISTIC_UUID = \"0000ffe1-0000-1000-8000-00805f9b34fb\"; // UUID da caracter√≠stica\n\n// ##################################################################\n\n// Interface para a estrutura da rota salva\ninterface SavedRoute {\n  name: string;\n  directions: google.maps.DirectionsResult;\n}\n\n// Interface para dispositivo Bluetooth\ninterface BluetoothDevice {\n  id: string;\n  name: string;\n  gatt?: BluetoothRemoteGATTServer;\n}\n\nconst containerStyle = {\n  width: '100%',\n  height: '100%'\n};\n\n// Adicionando uma constante para a dist√¢ncia de gatilho\nconst NAVIGATION_TRIGGER_DISTANCE_METERS = 50; // Dispara o envio da instru√ß√£o a 50 metros\n\nconst libraries: \"places\"[] = [\"places\"];\n\nfunction App() {\n  const { isLoaded } = useJsApiLoader({\n    id: 'google-map-script',\n    googleMapsApiKey: GOOGLE_MAPS_API_KEY,\n    libraries,\n  });\n\n  const [map, setMap] = useState<google.maps.Map | null>(null);\n  const [directionsResponse, setDirectionsResponse] = useState<google.maps.DirectionsResult | null>(null);\n  const [currentPosition, setCurrentPosition] = useState<google.maps.LatLngLiteral | null>(null);\n  const [simplifiedInstructions, setSimplifiedInstructions] = useState<string[]>([]);\n  \n  // Novos estados para gerenciar a navega√ß√£o e rotas salvas\n  const [isNavigating, setIsNavigating] = useState(false);\n  const [currentStepIndex, setCurrentStepIndex] = useState(0);\n  const [savedRoutes, setSavedRoutes] = useState<SavedRoute[]>([]);\n  const locationWatcherId = useRef<number | null>(null);\n  \n  // Novo estado para o modo offline\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\n  \n  // Estados para Bluetooth\n  const [isBluetoothConnected, setIsBluetoothConnected] = useState(false);\n  const [bluetoothDevice, setBluetoothDevice] = useState<BluetoothDevice | null>(null);\n  const [bluetoothCharacteristic, setBluetoothCharacteristic] = useState<BluetoothRemoteGATTCharacteristic | null>(null);\n  const [isConnectingBluetooth, setIsConnectingBluetooth] = useState(false);\n  \n  const destinationRef = useRef<HTMLInputElement>(null);\n\n  // Verificar se o navegador suporta Web Bluetooth\n  const isBluetoothSupported = () => {\n    return 'bluetooth' in navigator;\n  };\n\n  // Fun√ß√£o para conectar ao ESP32 via Bluetooth\n  const connectToESP32 = async () => {\n    if (!isBluetoothSupported() || !navigator.bluetooth) {\n      alert(\"Seu navegador n√£o suporta Web Bluetooth. Use Chrome ou Edge.\");\n      return;\n    }\n\n    setIsConnectingBluetooth(true);\n    \n    try {\n      // Solicitar dispositivo Bluetooth\n      const device = await navigator.bluetooth.requestDevice({\n        filters: [\n          {\n            name: ESP32_DEVICE_NAME\n          },\n          {\n            namePrefix: \"ESP32\"\n          }\n        ],\n        optionalServices: [ESP32_SERVICE_UUID]\n      });\n\n      console.log(\"Dispositivo selecionado:\", device.name);\n\n      // Conectar ao GATT Server\n      const server = await device.gatt?.connect();\n      if (!server) {\n        throw new Error(\"N√£o foi poss√≠vel conectar ao servidor GATT\");\n      }\n\n      // Obter o servi√ßo\n      const service = await server.getPrimaryService(ESP32_SERVICE_UUID);\n      \n      // Obter a caracter√≠stica para escrita\n      const characteristic = await service.getCharacteristic(ESP32_CHARACTERISTIC_UUID);\n      \n      // Habilitar notifica√ß√µes se dispon√≠vel\n      try {\n        await characteristic.startNotifications();\n        characteristic.addEventListener('characteristicvaluechanged', (event) => {\n          const target = event.target as unknown as BluetoothRemoteGATTCharacteristic;\n          const value = target.value;\n          if (value) {\n            const decoder = new TextDecoder();\n            const message = decoder.decode(value);\n            console.log(\"Mensagem recebida do ESP32:\", message);\n          }\n        });\n      } catch (error) {\n        console.log(\"Notifica√ß√µes n√£o dispon√≠veis, apenas escrita\");\n      }\n\n      setBluetoothDevice({\n        id: device.id,\n        name: device.name || ESP32_DEVICE_NAME,\n        gatt: server\n      });\n      setBluetoothCharacteristic(characteristic);\n      setIsBluetoothConnected(true);\n      \n      console.log(\"Conectado ao ESP32 via Bluetooth!\");\n      alert(\"Conectado ao ESP32 via Bluetooth!\");\n      \n    } catch (error) {\n      console.error(\"Erro ao conectar Bluetooth:\", error);\n      if (error instanceof Error) {\n        if (error.name === 'NotFoundError') {\n          alert(\"ESP32 n√£o encontrado. Verifique se est√° ligado e vis√≠vel.\");\n        } else if (error.name === 'NotAllowedError') {\n          alert(\"Permiss√£o negada para Bluetooth.\");\n        } else {\n          alert(`Erro de conex√£o: ${error.message}`);\n        }\n      } else {\n        alert(\"Erro desconhecido ao conectar Bluetooth.\");\n      }\n    } finally {\n      setIsConnectingBluetooth(false);\n    }\n  };\n\n  // Fun√ß√£o para desconectar Bluetooth\n  const disconnectBluetooth = async () => {\n    if (bluetoothDevice?.gatt?.connected) {\n      await bluetoothDevice.gatt.disconnect();\n    }\n    setBluetoothDevice(null);\n    setBluetoothCharacteristic(null);\n    setIsBluetoothConnected(false);\n    console.log(\"Desconectado do ESP32\");\n  };\n\n  // Fun√ß√£o para enviar instru√ß√£o via Bluetooth\n  const sendInstructionViaBluetooth = async (instruction: string) => {\n    if (!bluetoothCharacteristic || !isBluetoothConnected) {\n      console.error(\"Bluetooth n√£o conectado\");\n      return;\n    }\n\n    try {\n      const encoder = new TextEncoder();\n      const data = encoder.encode(instruction + '\\n'); // Adiciona quebra de linha\n      \n      await bluetoothCharacteristic.writeValue(data);\n      console.log(`Instru√ß√£o enviada via Bluetooth: ${instruction}`);\n    } catch (error) {\n      console.error(\"Erro ao enviar via Bluetooth:\", error);\n      alert(\"Erro ao enviar instru√ß√£o via Bluetooth. Verifique a conex√£o.\");\n    }\n  };\n\n  // Fun√ß√£o para enviar instru√ß√£o (agora usa Bluetooth em vez de HTTP)\n  const sendSingleInstructionToESP32 = async (instruction: string) => {\n    if (isBluetoothConnected) {\n      await sendInstructionViaBluetooth(instruction);\n    } else {\n      console.log(\"Bluetooth n√£o conectado. Instru√ß√£o n√£o enviada.\");\n      alert(\"Conecte ao ESP32 via Bluetooth primeiro.\");\n    }\n  };\n\n  useEffect(() => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(\n        (position) => {\n          const pos = {\n            lat: position.coords.latitude,\n            lng: position.coords.longitude,\n          };\n          setCurrentPosition(pos);\n          map?.panTo(pos);\n        },\n        () => {\n          alert(\"Erro: O servi√ßo de geolocaliza√ß√£o falhou.\");\n        }\n      );\n    } else {\n      alert(\"Erro: Seu navegador n√£o suporta geolocaliza√ß√£o.\");\n    }\n  }, [map]);\n\n  // Efeito para monitorar o status da conex√£o (online/offline)\n  useEffect(() => {\n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  // Efeito para carregar as rotas salvas do localStorage ao iniciar\n  useEffect(() => {\n    try {\n      const routesFromStorage = localStorage.getItem('savedNavigationRoutes');\n      if (routesFromStorage) {\n        setSavedRoutes(JSON.parse(routesFromStorage));\n      }\n    } catch (error) {\n      console.error(\"Erro ao carregar rotas do localStorage:\", error);\n      // Opcional: Limpar dados corrompidos\n      // localStorage.removeItem('savedNavigationRoutes');\n    }\n  }, []);\n\n  // Nova fun√ß√£o para calcular a dist√¢ncia entre dois pontos de GPS (f√≥rmula de Haversine)\n  const getDistanceInMeters = (pos1: google.maps.LatLngLiteral, pos2: google.maps.LatLngLiteral) => {\n    const R = 6371e3; // Metros\n    const p1 = (pos1.lat * Math.PI) / 180;\n    const p2 = (pos2.lat * Math.PI) / 180;\n    const deltaP = ((pos2.lat - pos1.lat) * Math.PI) / 180;\n    const deltaL = ((pos2.lng - pos1.lng) * Math.PI) / 180;\n    const a =\n      Math.sin(deltaP / 2) * Math.sin(deltaP / 2) +\n      Math.cos(p1) * Math.cos(p2) * Math.sin(deltaL / 2) * Math.sin(deltaL / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c; // em metros\n  };\n\n  const calculateRoute = async () => {\n    if (!isOnline) {\n      alert(\"Funcionalidade indispon√≠vel offline. Carregue uma rota salva.\");\n      return;\n    }\n    if (!destinationRef.current?.value || !currentPosition) {\n      return;\n    }\n    \n    const directionsService = new google.maps.DirectionsService();\n    const results = await directionsService.route({\n      origin: currentPosition,\n      destination: destinationRef.current.value,\n      travelMode: google.maps.TravelMode.DRIVING,\n      language: 'pt-BR', // Instru√ß√µes em Portugu√™s\n    });\n\n    setDirectionsResponse(results);\n    generateSimplifiedInstructions(results);\n  };\n  \n  const generateSimplifiedInstructions = (directions: google.maps.DirectionsResult) => {\n    if (!directions.routes || directions.routes.length === 0) {\n      return;\n    }\n    const route = directions.routes[0].legs[0];\n    const instructions = route.steps.map((step: google.maps.DirectionsStep) => {\n      // Remove tags HTML da instru√ß√£o (ex: <b>, <div>)\n      const cleanInstruction = step.instructions.replace(/<[^>]*>/g, '');\n      const distance = step.distance?.text || '';\n      return `${cleanInstruction} (${distance})`;\n    });\n    setSimplifiedInstructions(instructions);\n  };\n\n  // Fun√ß√µes para gerenciar rotas salvas\n  const saveCurrentRoute = () => {\n    if (!isOnline) {\n      alert(\"Funcionalidade indispon√≠vel offline.\");\n      return;\n    }\n    if (!directionsResponse || !destinationRef.current?.value) {\n      alert(\"Nenhuma rota calculada para salvar.\");\n      return;\n    }\n\n    const routeName = destinationRef.current.value;\n\n    if (savedRoutes.some(route => route.name === routeName)) {\n      if (!window.confirm(`Uma rota para \"${routeName}\" j√° existe. Deseja substitu√≠-la?`)) {\n        return;\n      }\n    }\n\n    const newRoute: SavedRoute = { name: routeName, directions: directionsResponse };\n    const updatedRoutes = savedRoutes.filter(route => route.name !== routeName);\n    updatedRoutes.push(newRoute);\n\n    setSavedRoutes(updatedRoutes);\n    localStorage.setItem('savedNavigationRoutes', JSON.stringify(updatedRoutes));\n    alert(`Rota para \"${routeName}\" salva com sucesso!`);\n  };\n\n  const loadSavedRoute = (routeToLoad: SavedRoute) => {\n    setDirectionsResponse(routeToLoad.directions);\n    generateSimplifiedInstructions(routeToLoad.directions);\n    setIsNavigating(false);\n    if (destinationRef.current) {\n        destinationRef.current.value = routeToLoad.name;\n    }\n    alert(`Rota para \"${routeToLoad.name}\" carregada.`);\n  };\n\n  const deleteSavedRoute = (indexToDelete: number) => {\n    if (window.confirm(\"Tem certeza que deseja deletar esta rota?\")) {\n      const updatedRoutes = savedRoutes.filter((_, index) => index !== indexToDelete);\n      setSavedRoutes(updatedRoutes);\n      localStorage.setItem('savedNavigationRoutes', JSON.stringify(updatedRoutes));\n    }\n  };\n\n  const stopNavigation = () => {\n    if (locationWatcherId.current !== null) {\n      navigator.geolocation.clearWatch(locationWatcherId.current);\n      locationWatcherId.current = null;\n    }\n    setIsNavigating(false);\n    alert(\"Navega√ß√£o encerrada.\");\n  };\n\n  const advanceToStep = useCallback((stepIndex: number) => {\n    if (!directionsResponse) return;\n    const route = directionsResponse.routes[0].legs[0];\n    if (stepIndex >= route.steps.length) {\n      sendSingleInstructionToESP32(\"Voc√™ chegou ao seu destino!\");\n      stopNavigation();\n      return;\n    }\n    const step = route.steps[stepIndex];\n    const instructionText = step.instructions.replace(/<[^>]*>/g, '');\n    sendSingleInstructionToESP32(instructionText);\n    setCurrentStepIndex(prevIndex => prevIndex + 1);\n  }, [directionsResponse]);\n\n  const handleLocationUpdate = useCallback((position: GeolocationPosition) => {\n    if (!directionsResponse?.routes[0]) return;\n    const userPosition: google.maps.LatLngLiteral = {\n      lat: position.coords.latitude,\n      lng: position.coords.longitude,\n    };\n    setCurrentPosition(userPosition);\n    const route = directionsResponse.routes[0].legs[0];\n    if (currentStepIndex >= route.steps.length) {\n      advanceToStep(currentStepIndex); // Para enviar a mensagem final\n      return;\n    }\n    const nextStep = route.steps[currentStepIndex];\n    \n    let nextStepLocation: google.maps.LatLngLiteral;\n    const startLocation = nextStep.start_location;\n\n    if (typeof startLocation.lat === 'function') {\n      nextStepLocation = { lat: startLocation.lat(), lng: startLocation.lng() };\n    } else {\n      nextStepLocation = startLocation as unknown as google.maps.LatLngLiteral;\n    }\n\n    const distance = getDistanceInMeters(userPosition, nextStepLocation);\n    if (distance < NAVIGATION_TRIGGER_DISTANCE_METERS) {\n      advanceToStep(currentStepIndex);\n    }\n  }, [directionsResponse, currentStepIndex, advanceToStep, getDistanceInMeters]);\n\n  const handleLocationError = useCallback((error: GeolocationPositionError) => {\n    alert(`Erro de geolocaliza√ß√£o: ${error.message}`);\n    stopNavigation();\n  }, []);\n  \n  // Este useEffect √© o c√©rebro da navega√ß√£o em tempo real\n  useEffect(() => {\n    if (!isNavigating) {\n        return;\n    }\n\n    locationWatcherId.current = navigator.geolocation.watchPosition(\n      handleLocationUpdate, \n      handleLocationError,\n      { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\n    );\n\n    return () => {\n      if (locationWatcherId.current !== null) {\n        navigator.geolocation.clearWatch(locationWatcherId.current);\n      }\n    };\n  }, [isNavigating, handleLocationUpdate, handleLocationError]);\n\n\n  const startNavigation = () => {\n    if (!directionsResponse) {\n      alert(\"Carregue uma rota primeiro.\");\n      return;\n    }\n    stopNavigation(); // Garante que qualquer watch anterior seja limpo\n    setCurrentStepIndex(0);\n    setIsNavigating(true);\n    alert(\"Iniciando a navega√ß√£o!\");\n  };\n  \n  const forceNextInstruction = () => {\n      if (!isNavigating) {\n          alert(\"A navega√ß√£o n√£o est√° ativa.\");\n          return;\n      }\n      advanceToStep(currentStepIndex);\n  };\n\n  if (!isLoaded) return <div>Carregando...</div>;\n\n  return (\n    <div className='app-container'>\n      <div className='sidebar'>\n        <div className='logo-container'>\n          <img src='/assets/Logo_Principal.png' alt=\"Logo\" className='logo-img' />\n        </div>\n        \n        {!isOnline && (\n          <div className='offline-banner'>\n            <p>MODO OFFLINE ATIVO</p>\n          </div>\n        )}\n\n        <div className='bluetooth-controls'>\n          <h3>üîµ Conex√£o Bluetooth</h3>\n          <div className='bluetooth-status'>\n            {isBluetoothConnected ? (\n              <div className='connected-status'>\n                <span className='status-indicator connected'></span>\n                <span>Conectado: {bluetoothDevice?.name}</span>\n                <button \n                  className='button disconnect-btn' \n                  onClick={disconnectBluetooth}\n                >\n                  Desconectar\n                </button>\n              </div>\n            ) : (\n              <div className='disconnected-status'>\n                <span className='status-indicator disconnected'></span>\n                <span>Desconectado</span>\n                <button \n                  className='button connect-btn' \n                  onClick={connectToESP32}\n                  disabled={isConnectingBluetooth}\n                >\n                  {isConnectingBluetooth ? 'Conectando...' : 'Conectar ESP32'}\n                </button>\n              </div>\n            )}\n          </div>\n          {!isBluetoothSupported() && (\n            <div className='bluetooth-warning'>\n              ‚ö†Ô∏è Seu navegador n√£o suporta Web Bluetooth. Use Chrome ou Edge.\n            </div>\n          )}\n        </div>\n\n        <div className='controls-container'>\n          <h2>Navega√ß√£o Ponto a Ponto</h2>\n          <div className='input-group'>\n            <Autocomplete>\n              <input \n                type='text' \n                placeholder='Destino' \n                ref={destinationRef}\n                disabled={!isOnline}\n              />\n            </Autocomplete>\n          </div>\n          <div className='button-group'>\n            <button \n              className='button' \n              onClick={calculateRoute}\n              disabled={!isOnline}\n            >\n              Obter Rota\n            </button>\n            <button \n              className='button' \n              onClick={saveCurrentRoute}\n              disabled={!isOnline}\n            >\n              Salvar Rota Atual\n            </button>\n          </div>\n        </div>\n\n        <div className='navigation-controls'>\n          <h3>Controle de Navega√ß√£o</h3>\n          <div className='button-group'>\n            {!isNavigating ? (\n                <button onClick={startNavigation} className='button start-nav-btn' disabled={!directionsResponse}>\n                    Iniciar Navega√ß√£o\n                </button>\n            ) : (\n                <button onClick={stopNavigation} className='button stop-nav-btn'>\n                    Parar Navega√ß√£o\n                </button>\n            )}\n            <button onClick={forceNextInstruction} className='button' disabled={!isNavigating}>\n                Pr√≥xima Instru√ß√£o (Teste)\n            </button>\n          </div>\n          {isNavigating && (\n              <p className='nav-status'>Navega√ß√£o em curso... Pr√≥ximo passo: {currentStepIndex + 1}</p>\n          )}\n        </div>\n\n        <div className='saved-routes-container'>\n          <h3>Rotas Salvas</h3>\n          <ul className='route-list'>\n            {savedRoutes.length > 0 ? (\n              savedRoutes.map((route, index) => (\n                <li key={index} className='route-item'>\n                  <span>{route.name}</span>\n                  <div className='route-item-buttons'>\n                    <button onClick={() => loadSavedRoute(route)}>Carregar</button>\n                    <button onClick={() => deleteSavedRoute(index)} className='delete-btn'>X</button>\n                  </div>\n                </li>\n              ))\n            ) : (\n              <p>Nenhuma rota salva.</p>\n            )}\n          </ul>\n        </div>\n\n        <div className='instructions-container'>\n            <h3>Instru√ß√µes</h3>\n            <ul className='instructions-list'>\n                {simplifiedInstructions.map((inst, index) => (\n                    <li key={index} className={index === currentStepIndex -1 ? 'current-instruction' : ''}>\n                        {inst}\n                    </li>\n                ))}\n            </ul>\n        </div>\n      </div>\n\n      <div className='map-container'>\n        {isOnline ? (\n          <GoogleMap\n            mapContainerStyle={containerStyle}\n            center={currentPosition || { lat: -23.55052, lng: -46.633308 }}\n            zoom={15}\n            onLoad={setMap}\n            options={{\n              mapTypeControl: false,\n              streetViewControl: false,\n              fullscreenControl: false,\n            }}\n          >\n            {directionsResponse && <DirectionsRenderer directions={directionsResponse} />}\n            {currentPosition && <Marker position={currentPosition} />}\n          </GoogleMap>\n        ) : (\n          <div className='offline-map-placeholder'>\n            <h2>Mapa indispon√≠vel em modo offline</h2>\n            <p>Use as rotas salvas para navegar. A sua localiza√ß√£o continua sendo rastreada.</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}